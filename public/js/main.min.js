// public/js/main.js
document.addEventListener("DOMContentLoaded", function() {
  const mobileBtn = document.getElementById("mobile-btn");
  const mobileMenu = document.getElementById("mobile-menu");
  if (mobileBtn && mobileMenu) {
    mobileBtn.addEventListener("click", () => {
      mobileMenu.classList.toggle("hidden");
      if (!mobileMenu.classList.contains("hidden")) {
        mobileMenu.classList.add("animate-slideDown");
        setTimeout(() => {
          mobileMenu.classList.remove("animate-slideDown");
        }, 300);
      }
    });
    const mobileLinks = mobileMenu.querySelectorAll("a");
    mobileLinks.forEach((link) => {
      link.addEventListener("click", () => {
        mobileMenu.classList.add("hidden");
      });
    });
  }
  function setupImagePreview(config) {
    const {
      fileInputId,
      previewId,
      removeBtnId,
      dropzoneId
    } = config;
    const fileInput = document.getElementById(fileInputId);
    const preview = document.getElementById(previewId);
    const removeBtn = document.getElementById(removeBtnId);
    const dropzone = dropzoneId ? document.getElementById(dropzoneId) : null;
    if (!fileInput || !preview || !removeBtn) {
      return false;
    }
    const previewImg = preview.querySelector("img");
    if (!previewImg) {
      return false;
    }
    fileInput.addEventListener("change", function(e) {
      if (this.files && this.files[0]) {
        const file = this.files[0];
        const validTypes = ["image/jpeg", "image/png", "image/webp"];
        if (!validTypes.includes(file.type)) {
          alert("Por favor, sube una imagen v√°lida (JPEG, PNG o WEBP)");
          this.value = "";
          return;
        }
        const reader = new FileReader;
        reader.onload = function(e2) {
          previewImg.src = e2.target.result;
          preview.classList.remove("hidden");
          if (dropzone)
            dropzone.classList.add("hidden");
        };
        reader.readAsDataURL(file);
      }
    });
    removeBtn.addEventListener("click", function(e) {
      e.preventDefault();
      fileInput.value = "";
      preview.classList.add("hidden");
      if (dropzone)
        dropzone.classList.remove("hidden");
    });
    return true;
  }
  const devolucionPreview = setupImagePreview({
    fileInputId: "evidencia",
    previewId: "preview",
    removeBtnId: "removeImage",
    dropzoneId: "dropzone"
  });
  const agregarPreview = setupImagePreview({
    fileInputId: "foto",
    previewId: "preview",
    removeBtnId: "removeImage",
    dropzoneId: "dropzone"
  });
});
